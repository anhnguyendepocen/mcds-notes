---
title: "Lecture 1: Maximum Likelihood"
output: html_notebook
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
```

The first section is about different probability distributions and their parameters. 

```{r Normal distribution}
x <- seq(-10, 10, 0.1)

y1a <- dnorm(x, 0, 2.0)
y1b <- dnorm(x, 1, 2.0)
y1c <- dnorm(x, 3, 2.0)

y2a <- dnorm(x, 0.0, 0.5)
y2b <- dnorm(x, 0.0, 1.0)
y2c <- dnorm(x, 0.0, 2.0)

d1 <- data.frame(x = rep(x, 3), 
                 y = c(y1a, y1b, y1c),
                 c = c(rep(0, length(x)), rep(1, length(x)), rep(3, length(x))))
d2 <- data.frame(x = rep(x, 3), 
                 y = c(y2a, y2b, y2c),
                 c = c(rep(0.5, length(x)), rep(1.0, length(x)), rep(2.0, length(x))))

p1 <- ggplot(d1) + geom_line(aes(x=x, y=y, colour=as.factor(c))) + theme_minimal() + 
  scale_colour_discrete(name=expression(mu)) + xlab("") + ylab("")
ggsave(p1, filename="../img/l01-figure1-normal-mean-change.png", height=3, width=6, units="in", dpi=300)

p2 <- ggplot(d2) + geom_line(aes(x=x, y=y, colour=as.factor(c))) + theme_minimal() + 
  scale_colour_discrete(name=expression(sigma)) + xlab("") + ylab("")
ggsave(p2, filename="../img/l01-figure2-normal-sd-change.png", height=3, width=6, units="in", dpi=300)

```

And now for the binomial distribution...

```{r Binomial distribution}
x <- seq(0, 60, 1)

y3a <- dbinom(x, 10, 0.5)
y3b <- dbinom(x, 50, 0.5)
y3c <- dbinom(x, 80, 0.5)

y4a <- dbinom(x, 50, 0.2)
y4b <- dbinom(x, 50, 0.5)
y4c <- dbinom(x, 50, 0.9)

d3 <- data.frame(x = rep(x, 3), 
                 y = c(y3a, y3b, y3c),
                 c = c(rep(10, length(x)), rep(50, length(x)), rep(80, length(x))))
d4 <- data.frame(x = rep(x, 3), 
                 y = c(y4a, y4b, y4c),
                 c = c(rep(0.2, length(x)), rep(0.5, length(x)), rep(0.9, length(x))))

p3 <- ggplot(d3, aes(x=x, y=y, fill=as.factor(c))) + 
  geom_bar(data = subset(d3, c==10), stat = "identity", colour=NA, alpha=0.5) +
  geom_bar(data = subset(d3, c==50), stat = "identity", colour=NA, alpha=0.5) +
  geom_bar(data = subset(d3, c==80), stat = "identity", colour=NA, alpha=0.5) +
  theme_minimal() + scale_fill_discrete(name="n") + xlab("") + ylab("") + xlim(0, 60)
ggsave(p3, filename="../img/l01-figure3-binom-n-change.png", height=3, width=6, units="in", dpi=300)

p4 <- ggplot(d4, aes(x=x, y=y, fill=as.factor(c))) + 
  geom_bar(data = subset(d4, c==0.2), stat = "identity", colour=NA, alpha=0.5) +
  geom_bar(data = subset(d4, c==0.5), stat = "identity", colour=NA, alpha=0.5) +
  geom_bar(data = subset(d4, c==0.9), stat = "identity", colour=NA, alpha=0.5) +
  theme_minimal() + scale_fill_discrete(name=expression(mu)) + xlab("") + ylab("") + xlim(0, 52)
ggsave(p4, filename="../img/l01-figure4-binom-p-change.png", height=3, width=6, units="in", dpi=300)

n <- 100
p <- seq(0.0, 1.0, 0.01)

d5 <- data.frame(mean.binom = n*p, var.binom = n*p*(1-p))

p5 <- ggplot(d5) + geom_point(aes(x=mean.binom, y=var.binom), pch=21, 
                              colour="gray50", fill="gray30", alpha=0.6, size=1.0) +
  xlab("Mean (Binomial)") + ylab("Variance (Binomial)") + theme_minimal()
ggsave(p5, filename="../img/l01-figure5-mean-var-binomial.png", height=3, width=3.5, units="in", dpi=300)

```

```{r Poisson distribution}
x <- seq(0, 25, 1)

y1d <- dpois(x, 1)
y1a <- dpois(x, 3)
y1b <- dpois(x, 7)
y1c <- dpois(x, 15)

d6 <- data.frame(x = rep(x, 4), 
                 y = c(y1d, y1a, y1b, y1c),
                 c = c(rep(1, length(x)), rep(3, length(x)), rep(7, length(x)), rep(15, length(x))))

p6 <- ggplot(d6, aes(x=x, y=y, colour=as.factor(c))) + geom_line() + geom_point() + 
  theme_minimal() + scale_colour_discrete(name=expression(lambda)) + xlab("") + ylab("")
ggsave(p6, filename="../img/l01-figure3a-poisson-lambda-change.png", height=3, width=6, units="in", dpi=300)
```

```{r Geometric distribution}
x <- seq(0, 15, 1)

y1d <- dgeom(x, 0.1)
y1a <- dgeom(x, 0.3)
y1b <- dgeom(x, 0.5)

d7 <- data.frame(x = rep(x, 3), 
                 y = c(y1d, y1a, y1b),
                 c = c(rep(0.1, length(x)), rep(0.3, length(x)), rep(0.5, length(x))))

p7 <- ggplot(d7, aes(x=x, y=y, colour=as.factor(c))) + geom_line() + geom_point() + 
  theme_minimal() + scale_colour_discrete(name=expression(mu)) + xlab("") + ylab("")
ggsave(p7, filename="../img/l01-figure4-geometric-mu-change.png", height=3, width=6, units="in", dpi=300)
```

```{r Exponential distribution}
x <- seq(0, 15, 0.1)

y1d <- dexp(x, 0.1)
y1a <- dexp(x, 0.3)
y1b <- dexp(x, 0.5)

d7 <- data.frame(x = rep(x, 3), 
                 y = c(y1d, y1a, y1b),
                 c = c(rep(0.1, length(x)), rep(0.3, length(x)), rep(0.5, length(x))))

p7 <- ggplot(d7, aes(x=x, y=y, colour=as.factor(c))) + geom_line() + 
  theme_minimal() + scale_colour_discrete(name=expression(lambda)) + xlab("") + ylab("")
ggsave(p7, filename="../img/l01-figure5-exponential-lambda-change.png", height=3, width=6, units="in", dpi=300)
```

```{r Datagen: bernoulli}
d <- rbinom(10, 1, 0.3)
```

```{r Datagen: normal}
d.norm <- rnorm(1000, 92, 10.6)
p <- ggplot() + geom_histogram(aes(x=d.norm), alpha=0.6, fill="seagreen") + theme_minimal() + xlab("x(i)")

```

```{r Datagen: poisson}
d.pois <- rpois(20, 7.0)
p <- ggplot() + geom_bar(aes(x=d.pois), alpha=0.6, fill="orange") + theme_minimal() + xlab("x(i)")

```

```{r Datagen: geometric}
d.geom <- rgeom(10, 0.4) 
p <- ggplot() + geom_bar(aes(x=d.geom), alpha=0.6, fill="blue3") + theme_minimal() + xlab("x(i)")
```

```{r Datagen: exponential}
d.exp <- rexp(10, 0.4)
p <- ggplot() + geom_histogram(aes(x=d.exp), alpha=0.6, fill="turquoise4") + theme_minimal() + xlab("x(i)")
```
